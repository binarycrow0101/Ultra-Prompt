<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Mystic Radio Tuner</title>
<style>
  body {
    margin: 0;
    height: 100vh;
    background: radial-gradient(circle at center, #050505 30%, #000 100%);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    font-family: "Courier New", monospace;
    color: #0ff;
    overflow: hidden;
  }

  .screen {
    width: min(90vw, 440px);
    height: min(25vh, 160px);
    background: #001;
    border: 3px solid #0ff5;
    box-shadow: 0 0 30px #0ff2;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #0ff;
    font-size: 1.1em;
    text-align: center;
    position: relative;
    overflow: hidden;
  }

  .scanline {
    position: absolute;
    top: -50%;
    left: 0;
    width: 100%;
    height: 200%;
    background: linear-gradient(to bottom, transparent 48%, rgba(255,255,255,0.03) 50%, transparent 52%);
    animation: scan 4s linear infinite;
    pointer-events: none;
  }

  @keyframes scan {
    from { transform: translateY(-50%); }
    to { transform: translateY(0%); }
  }

  .staticCanvas, .whisperCanvas {
    position: absolute;
    inset: 0;
    pointer-events: none;
    z-index: 2;
  }

  .dial {
    width: 160px;
    height: 160px;
    background: radial-gradient(circle, #222 0%, #000 90%);
    border: 4px solid #0ff5;
    border-radius: 50%;
    margin-top: 50px;
    position: relative;
    box-shadow: 0 0 30px #0ff2 inset;
    cursor: grab;
  }

  .pointer {
    position: absolute;
    width: 4px;
    height: 50px;
    background: #0ff;
    top: 15px;
    left: calc(50% - 2px);
    border-radius: 2px;
    transform-origin: bottom center;
  }

  .static {
    animation: staticText 0.15s steps(5) 12;
  }

  @keyframes staticText {
    0%,100% { opacity: 1; filter: blur(0); }
    25% { opacity: 0.3; filter: blur(2px); }
    50% { opacity: 1; filter: blur(1px); }
    75% { opacity: 0.6; filter: blur(3px); }
  }

  .mist {
    position: absolute;
    width: 800px;
    height: 800px;
    top: -300px;
    background: radial-gradient(circle, rgba(0,255,255,0.1) 0%, transparent 70%);
    filter: blur(100px);
    animation: drift 20s linear infinite alternate;
  }

  @keyframes drift {
    from { transform: translateX(-100px) translateY(0px); }
    to { transform: translateX(100px) translateY(50px); }
  }

  .assembled span {
    opacity: 0;
    display: inline-block;
    animation: assemble 0.05s linear forwards;
  }

  @keyframes assemble {
    to { opacity: 1; filter: blur(0); }
  }
</style>
</head>
<body>
  <div class="mist"></div>
  <div class="screen" id="screen">
    <canvas class="staticCanvas" id="staticCanvas"></canvas>
    <canvas class="whisperCanvas" id="whisperCanvas"></canvas>
    <div class="scanline"></div>
    <div id="text">~ tuning ~</div>
  </div>
  <div class="dial" id="dial">
    <div class="pointer" id="pointer"></div>
  </div>

<script>
// ---- Audio Setup ----
const sounds = {
  static: new Audio('sounds/static.mp3'),
  click: new Audio('sounds/click.mp3'),
  lock: new Audio('sounds/lock.mp3'),
  hum: new Audio('sounds/hum.mp3'),
  blip: new Audio('sounds/blip.mp3'),
  bgm: new Audio('sounds/background.mp3')
};

sounds.hum.loop = true;
sounds.bgm.loop = true;
sounds.hum.volume = 0.2;
sounds.bgm.volume = 0.25;

// Start background hum/music
window.addEventListener('click', () => {
  sounds.hum.play();
  sounds.bgm.play();
}, { once: true });

// ---- DOM References ----
const screen = document.getElementById('screen');
const textEl = document.getElementById('text');
const dial = document.getElementById('dial');
const pointer = document.getElementById('pointer');
const staticCanvas = document.getElementById('staticCanvas');
const ctx = staticCanvas.getContext('2d');

// ---- Static Noise ----
function drawStatic() {
  const w = staticCanvas.width = staticCanvas.offsetWidth;
  const h = staticCanvas.height = staticCanvas.offsetHeight;
  const imageData = ctx.createImageData(w, h);
  for (let i = 0; i < imageData.data.length; i += 4) {
    const v = Math.random() * 255;
    imageData.data[i] = imageData.data[i + 1] = imageData.data[i + 2] = v;
    imageData.data[i + 3] = Math.random() < 0.9 ? 40 : 90;
  }
  ctx.putImageData(imageData, 0, 0);
}
let staticActive = true;
function animateStatic() {
  if (staticActive) drawStatic();
  requestAnimationFrame(animateStatic);
}
animateStatic();

// ---- Dream Residue Data ----
const dreamResidue = {
  roles: ["Frog","Elephant","Boar","Raven","Giraffe","Tapir","Weasel","Otter","Beaver","Buffalo","Cow","Spider","Rabbit","Dog","Dinosaur","Octopus","Penguin","Crab","Cat","Bear","Lion","Badgers","Xenomorph","Android","Shark","Unicorn","Shrimp","Raccoon","Turtle","Rat","Pony","Tiger","Ant","Bat","Koala","Sloth","Dragon","Chinchilla","Skeleton","Pigeon","Lobster","Walrus","Armadillo","Chicken","Goblin","Mermaid","Centaur","Werewolf","Vampire Bat","Gnome","Fairy","Alien Blob","Robot Dog","Mutant Hamster","Zombie Cat","Cyborg Chicken","Mini Dragon","Space Slug","Tentacle Monster","Flying Fish","Talking Donkey","Living Rock","A Painting of a","Haunted Doll","Giant Rat","Fire Sprite","Ice Golem","Shadow Beast","Moon Rabbit","Pumpkin Monster","Cosmic Owl","Time Traveler","Ghost Parrot","Invisible Cat","Frost Troll","Sand Worm","Banana Knight","Chocolate Ogre","Cheese Dragon","Sock Monster","Killer Whale","Fox","Neon Tiger","Gummy Bear","Jellyfish","Vortex Frog","Crazy Chicken"],
  subjects: ["Knight","Wizard","Healer","Archer","Bard","Thief","Necromancer","Paladin","Barbarian","Alchemist","Engineer","Inventor","Pilot","Captain","Admiral","Navigator","Spy","Assassin","Scout","Soldier","General","Guard","Jester","King","Queen","Prince","Princess","Peasant","Farmer","Blacksmith","Miner","Merchant","Scholar","Librarian","Teacher","Student","Priest","Monk","Oracle","Prophet","Shaman","Druid","Hunter","Fisherman","Cook","Butcher","Baker","Brewer","Innkeeper","Explorer","Cartographer","Sailor","Pirate","Smuggler","Outlaw","Sheriff","Detective","Investigator","Doctor","Surgeon","Nurse","Witch Doctor","Mechanic","Taxi Driver","Racer","Athlete","Gladiator","Champion","Wrestler","Boxer","Samurai","Ronin","Ninja","Sensei","Mentor","Apprentice","Magician","Illusionist","Fortune Teller","Trickster","Hero","Villain","Antihero","Rebel","Revolutionary","Diplomat","Ambassador","Politician","Judge","Lawyer","Banker","Thug","Crime Boss","Cult Leader","Prophet of Doom","Herald","Delivery","Courier","Wanderer","Hermit","Nomad","Survivor","Scientist","Astronaut","Alien","Robot","Hacker","AI Core","Space Marine","Influencer","Starship Captain","Time Traveler","Historian","Archivist","Storyteller","Painter","Musician","Sculptor","Poet","Philosopher","Dreamer","Visionary","Madman","Trickster God","Demi-God","Spirit Guardian","Elemental","Shape-shifter","CEO","Zombie","Vampire","Muppet","Sock Puppet","Kaiju","Transforming","Hippy","Crusty"],
  actions: ["dancing","sleeping","baking cupcakes","juggling","painting","singing","fighting","building a Lego set","haunting","surfing","moonwalking","shopping","arguing","reading","working","driving a golf cart","climbing","eating cheese","solving a mystery","being disgusted","slaying","playing football","competing in a staring match","performing a musical","wearing tiny trousers","sharing a dessert","serving drinks","playing pinball","fishing","carving wooden spoons","eating pizza","riding a T-Rex","casting spells","building a time machine","climbing a volcano","teleporting","taming a dragon","stealing treasure","creating a potion","swinging on vines","jumping through portals","painting graffiti","singing opera","writing a novel","escaping a maze","riding a comet","dueling with swords","feeding unicorns","swimming with sharks","playing pranks","solving riddles","baking a magical cake","testing a jetpack","training minions","fighting off zombies","wrangling ghosts","building a cheese fortress","stealing a crown","casting shadow puppets","racing kangaroos","wrestling giant frogs","conducting an orchestra","driving a UFO"],
  contexts: ["in the Congo","at a TED convention","in a castle","in a spaceship","on the moon","in a haunted house","in a circus","in a swamp","in a library","in a volcano","in a coffee shop","at a wedding","at a funeral","in a classroom","on a pirate ship","on stage","in a candy store","in a barber shop","at a fashion show","in a pub","at Disney World","in the big city","on a zoom call","during armageddon","in a sewer","on the subway","in hell","in the middle of traffic","at a silent disco","in a gladiator arena","underwater in Atlantis","on a floating island","at the edge of time"]
};

// ---- Prompt Generators ----
function dreamPrompt() {
  const r = rand(dreamResidue.roles);
  const s = rand(dreamResidue.subjects);
  const a = rand(dreamResidue.actions);
  const c = rand(dreamResidue.contexts);
  return `${r} ${s} ${a} ${c}.`;
}

function rand(a) { return a[Math.floor(Math.random() * a.length)]; }

// ---- Dial Interaction ----
let currentAngle = 0, dragging = false, lastAngle = 0;
dial.addEventListener('mousedown', e => {
  dragging = true;
  lastAngle = angleFromEvent(e);
  dial.style.cursor = 'grabbing';
  sounds.click.play();
  staticActive = true;
  fadeVolume(sounds.static, 0.3, 200);
  sounds.static.play();
});
document.addEventListener('mouseup', () => {
  dragging = false;
  dial.style.cursor = 'grab';
  fadeVolume(sounds.static, 0, 500);
});
document.addEventListener('mousemove', e => {
  if (!dragging) return;
  const newAngle = angleFromEvent(e);
  const delta = newAngle - lastAngle;
  currentAngle = (currentAngle + delta) % 360;
  lastAngle = newAngle;
  pointer.style.transform = `rotate(${currentAngle}deg)`;
  if (!sounds.static.paused) sounds.static.currentTime = 0;
  showStatic("~ Dream Residue ~");
  setTimeout(() => displayPhrase(dreamPrompt()), 1000);
});
function angleFromEvent(e) {
  const rect = dial.getBoundingClientRect();
  const cx = rect.left + rect.width / 2;
  const cy = rect.top + rect.height / 2;
  const dx = e.clientX - cx;
  const dy = e.clientY - cy;
  return Math.atan2(dy, dx) * 180 / Math.PI;
}

// ---- Screen Display ----
function showStatic(label) {
  textEl.textContent = label;
  textEl.classList.add('static');
  setTimeout(() => textEl.classList.remove('static'), 400);
}
function displayPhrase(text) {
  staticActive = false;
  ctx.clearRect(0, 0, staticCanvas.width, staticCanvas.height);
  textEl.innerHTML = "";
  const container = document.createElement('div');
  container.className = 'assembled';
  for (const ch of text) {
    const span = document.createElement('span');
    span.textContent = ch;
    span.style.animationDelay = (Math.random() * 0.8) + 's';
    container.appendChild(span);
  }
  textEl.appendChild(container);
}

// ---- Audio Fade Utility ----
function fadeVolume(sound, target, duration) {
  const start = sound.volume;
  const startTime = Date.now();
  const step = setInterval(() => {
    const t = Math.min(1, (Date.now() - startTime) / duration);
    sound.volume = start + (target - start) * t;
    if (t === 1) clearInterval(step);
  }, 30);
}
</script>
</body>
</html>
